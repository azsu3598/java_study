### 토큰 기반 인증

- 토큰 기반 인증
  - 1. 클라이언트가 아이디와 비밀번호를 서버에게 전달하면서 인증을 요청
  - 2. 서버는 아이디와 비밀번호를 확인해 유효한 사용자인지 검증, 유효한 사용자면 토큰을 생성해서 응답
  - 3. 클라이언트는 서버에서 준 토큰 저장
  - 4. 인증이 필요한 API를 사용할 대 토큰을 함께 보냄
  - 5. 서버는 토큰이 유요한지 검사
  - 6. 토큰이 유효하다면 클라이언트가 요청한 내용 처리
- 특징

  - 1. 무상태성 - 인증 정보를 서버가 아닌 클라이언트가 소지
  - 2. 확장성
  - 3. 무결성

- JWT

  - 발급받은 JWT를 이용해 인증을 하려면 HTTP 요청 헤더 중에 Authorization 키 값에 Bearer + JWT 토큰값을 넣어 보내야 한다.
  - JWT는 .(점)을 기준으로 헤더, 내용, 서명으로 이루어진다.
    - 헤더 : 토큰의 타입과 해싱 알고리즘을 지정하는 정보를 담는다.
    - 내용 : 토큰과 관련된 정보를 담는다.
      - 내용의 한 덩어리를 '클레임' 이라고 부르며, 클레임은 키값 한쌍으로 이루어진다.
      - 등록된 클레임, 공개 클레임, 비공개 클레임으로 나뉜다.
        - 등록된 클레임
          - iss : 토큰 발급자
          - sub : 토큰 제목
          - aud : 토큰 대상자
          - exp : 토큰의 만료 시간, 시간은 NumericDate 형식으로 한다.
          - nbf : 토큰의 활성 날짜와 비슷한 개념, 이 날짜가 지나기 전까지는 토큰이 처리되지 않는다.
          - iat : 토큰이 발급된 시간
          - jti : JWT의 고유 식별자, 주로 일회용 토큰에 사용
        - 공개 클레임
          - 공개되어도 상관없는 클레임
          - 보통 이름을 URI로 짓는다.
        - 비공개 클레임
          - 공개되면 안되는 클레임
    - 서명
      - 해당 토큰이 조작되었거나 변경되지 않았음을 확인하는 용도로 사용
      - 헤더의 인코딩값과 내용의 인코딩값을 합치 후에 주어진 비밀키를 사용해 해시값을 생성한다.

- JWT 서비스 구현
  - 1. 의존성 추가
  - 2. 토큰 제공자 추가
  - 3. 리프레시 토큰 도메인 구현
  - 4. 토큰 필터 구현
    - 1. 요청
    - 2. 유효하면 시큐리티 컨텍스트 홀더에 인증 정보를 저장
    - 3. 서비스 로직 실행
    - 4. 응답
  - 5. 토큰 API 구현
